<div class="reset-container">
    <mat-card class="reset-card" *ngIf="sessionExists; else invalidLink">
        <mat-card-header>
            <mat-card-title>Nueva contraseña</mat-card-title>
        </mat-card-header>

        <mat-card-content>
            <form [formGroup]="form" (ngSubmit)="updatePassword()">
                <mat-form-field appearance="outline" class="full-width-input">
                    <mat-label>Contraseña</mat-label>
                    <input matInput type="password" formControlName="password" autocomplete="new-password" required>
                    <mat-error *ngIf="form.controls['password'].hasError('required')">
                        Requerido
                    </mat-error>
                    <mat-error *ngIf="form.controls['password'].hasError('minlength')">
                        Mínimo 6 caracteres
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width-input">
                    <mat-label>Confirmar contraseña</mat-label>
                    <input matInput type="password" formControlName="confirm" autocomplete="new-password" required>
                    <mat-error *ngIf="form.controls['confirm'].hasError('required')">
                        Requerido
                    </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" [disabled]="submitting || form.invalid">
                    {{ submitting ? 'Actualizando…' : 'Actualizar contraseña' }}
                </button>

                <div *ngIf="successMessage" class="success">{{ successMessage }}</div>
                <div *ngIf="errorMessage" class="error">{{ errorMessage }}</div>
            </form>
        </mat-card-content>
    </mat-card>

    <ng-template #invalidLink>
        <mat-card class="reset-card">
            <mat-card-content>
                <p class="error">{{ errorMessage }}</p>
            </mat-card-content>
        </mat-card>
    </ng-template>
</div>